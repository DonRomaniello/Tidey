{"ast":null,"code":"import _slicedToArray from\"/Users/donromaniello/Code/JavaScript/tidey/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{fetchHarmonics}from'../store/features/harmonics';import L from'leaflet';import{Marker,Popup}from'react-leaflet';import drawVisualizer from'./modules/drawHarmonicConstituents';import icon from'./assets/pin.svg';// import iconShadow from 'leaflet/dist/images/marker-shadow.png';\n// import styles from './css/Epicycles.module.css'\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Epicycles=function Epicycles(props){var stationInfo=props.stationInfo;var harmonics=useSelector(function(state){return state.harmonics;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),couldOpen=_useState2[0],setCouldOpen=_useState2[1];var dispatch=useDispatch();var DefaultIcon=L.icon({iconUrl:icon,// shadowUrl: iconShadow,\niconAnchor:[16,42],popupAnchor:[-50,0]// this should be half width, full height of popup\n});L.Popup.prototype.options.offset=[0,0];// look here\nL.Marker.prototype.options.icon=DefaultIcon;L.Popup.prototype.options.maxWidth='1000%';L.Popup.prototype.options.className='popuply';var position=[stationInfo===null||stationInfo===void 0?void 0:stationInfo.lat,stationInfo===null||stationInfo===void 0?void 0:stationInfo.lng];var canvasName=\"epicycleCanvas + \".concat(stationInfo.id+stationInfo.lat+stationInfo.lng);var autoPanPad={x:(window.innerWidth-500)/2,y:(window.innerHeight-300)/2};var stopLooping=function stopLooping(){return{continue:couldOpen,numOfConstituents:5};};useEffect(function(){if(harmonics.loaded&&couldOpen){drawVisualizer(harmonics.harmonics,canvasName,constituentColors,[400,200],stopLooping);}},[canvasName,couldOpen,harmonics]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Marker,{maxWidth:\"400px\",position:position,autoPan:true,autoPanOnFocus:true,riseOnHover:true,eventHandlers:{popupopen:function popupopen(){dispatch(fetchHarmonics(stationInfo.harmonicConstituents));setCouldOpen(true);},popupclose:function popupclose(){setCouldOpen(false);}},children:/*#__PURE__*/_jsx(Popup,{autoPanPadding:autoPanPad,autoPan:true,children:harmonics.loaded&&couldOpen?/*#__PURE__*/_jsx(\"canvas\",{id:canvasName}):/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"loading...\"})})})});};var constituentColors={start:{r:22,g:105,b:122},end:{r:134,g:216,b:154}};export default Epicycles;","map":{"version":3,"names":["React","useState","useEffect","useDispatch","useSelector","fetchHarmonics","L","Marker","Popup","drawVisualizer","icon","Epicycles","props","stationInfo","harmonics","state","couldOpen","setCouldOpen","dispatch","DefaultIcon","iconUrl","iconAnchor","popupAnchor","prototype","options","offset","maxWidth","className","position","lat","lng","canvasName","id","autoPanPad","x","window","innerWidth","y","innerHeight","stopLooping","continue","numOfConstituents","loaded","constituentColors","popupopen","harmonicConstituents","popupclose","start","r","g","b","end"],"sources":["/Users/donromaniello/Code/JavaScript/tidey/src/components/Epicycles.js"],"sourcesContent":["\nimport React, {useState, useEffect} from 'react';\n\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { fetchHarmonics } from '../store/features/harmonics';\n\nimport L from 'leaflet';\n\nimport {\n  Marker,\n  Popup,\n} from 'react-leaflet'\n\n\nimport drawVisualizer from './modules/drawHarmonicConstituents';\n\nimport icon from './assets/pin.svg';\n\n// import iconShadow from 'leaflet/dist/images/marker-shadow.png';\n\n// import styles from './css/Epicycles.module.css'\n\nconst Epicycles = (props) => {\n\n  const { stationInfo } = props\n\n  const harmonics = useSelector((state) => state.harmonics)\n\n  const [couldOpen, setCouldOpen] = useState(false)\n\n  const dispatch = useDispatch();\n\n  const DefaultIcon = L.icon({\n    iconUrl: icon,\n    // shadowUrl: iconShadow,\n    iconAnchor: [16, 42],\n    popupAnchor: [-50, 0],// this should be half width, full height of popup\n  });\n\n  L.Popup.prototype.options.offset = [0,0] // look here\n\n  L.Marker.prototype.options.icon = DefaultIcon;\n\n  L.Popup.prototype.options.maxWidth = '1000%'\n\n  L.Popup.prototype.options.className = 'popuply'\n\n  const position = [stationInfo?.lat, stationInfo?.lng]\n\n  const canvasName = `epicycleCanvas + ${stationInfo.id + stationInfo.lat + stationInfo.lng}`\n\n  const autoPanPad = {\n    x: (window.innerWidth - 500) / 2,\n    y: (window.innerHeight - 300) / 2,\n }\n\n  const stopLooping = () => {\n    return {\n      continue: couldOpen,\n      numOfConstituents: 5,\n  }\n}\n\n  useEffect(() => {\n    if (harmonics.loaded && couldOpen) {\n      drawVisualizer(harmonics.harmonics, canvasName, constituentColors,\n        [400, 200], stopLooping)\n    }\n  }, [canvasName, couldOpen, harmonics])\n\n  return (\n    <>\n    <Marker\n    maxWidth='400px'\n    position={position}\n    autoPan={true}\n    autoPanOnFocus={true}\n    riseOnHover={true}\n    eventHandlers={{\n      popupopen: () => {\n        dispatch(fetchHarmonics(stationInfo.harmonicConstituents))\n        setCouldOpen(true);\n      },\n      popupclose: () => {\n        setCouldOpen(false)\n      }\n    }}\n    >\n      <Popup\n      autoPanPadding={autoPanPad}\n      autoPan={true}\n      >\n        {((harmonics.loaded) && couldOpen) ?\n          <canvas id={canvasName}/>\n            :\n          <div className='loading' >\n            loading...\n            </div>}\n      </Popup>\n    </Marker>\n    </>\n)\n}\n\nconst constituentColors = {\n  start : {\n    r: 22,\n    g: 105,\n    b: 122\n  },\n  end : {\n    r: 134,\n    g: 216,\n    b: 154\n  }\n}\n\n\n\nexport default Epicycles\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}